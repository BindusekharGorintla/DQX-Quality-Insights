qdr_qc_1:
  - criticality: error
    check:
      arguments:
        expression: bith_date and ssn is not null
        msg: Flag if bith_date and ssn is not null 
      function: sql_expression
    user_metadata:
      table_name: member
      unique_key: mem_key
      validation_key: bith_date and ssn
      sql_query: with cte as (
                select distinct m.mem_id, m.mem_name, m.birth_date,m.ssn,m.death_date, m.medicaid,m.medicare
                from {gold.qdr.catalog.name}.qdr_gold.member m
                )
                select * from cte where
                cte.birth_date is null or cte.ssn is null
